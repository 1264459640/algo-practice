# 泛洪算法项目使用指南

## 1. 项目概述

本项目实现了完整的泛洪算法（Flood Fill），包含三种不同的算法实现方式，并提供了控制台演示和Godot可视化界面。

## 2. 环境要求

### 2.1 基础环境
- **.NET 8.0** 或更高版本
- **Godot 4.4.1** 或更高版本（用于可视化界面）
- **Windows/Linux/macOS** 操作系统

### 2.2 开发环境（可选）
- **Visual Studio 2022** 或 **Visual Studio Code**
- **Godot编辑器**

## 3. 项目结构

```
flood-fill/
├── src/                    # 源代码目录
│   ├── FloodFill.cs       # 核心算法实现
│   ├── Grid.cs            # 网格数据结构
│   ├── FloodFillResult.cs # 算法结果类
│   ├── ConsoleDemo.cs     # 控制台演示
│   ├── FloodFillVisualizer.cs # Godot可视化界面
│   └── Program.cs         # 程序入口点
├── docs/                  # 文档目录
│   ├── 算法原理.md        # 算法原理详解
│   └── 使用指南.md        # 本文档
├── FloodFill.csproj       # 项目文件
├── FloodFill.sln          # 解决方案文件
├── project.godot          # Godot项目配置
├── Main.tscn              # Godot主场景
├── icon.svg               # 项目图标
└── README.md              # 项目说明
```

## 4. 快速开始

### 4.1 编译项目

```bash
# 进入项目目录
cd flood-fill

# 清理项目
dotnet clean

# 编译项目
dotnet build
```

### 4.2 运行控制台演示

```bash
# 运行控制台演示
dotnet run --console
```

### 4.3 运行Godot可视化界面

1. 打开Godot编辑器
2. 导入项目（选择 `project.godot` 文件）
3. 点击运行按钮或按F5

## 5. 控制台演示功能

控制台演示包含以下功能模块：

### 5.1 基本填充演示
- 展示基本的泛洪填充功能
- 显示填充前后的网格状态
- 统计填充的单元格数量

### 5.2 算法比较演示
- 比较递归、栈、队列三种算法的性能
- 显示执行时间和内存使用情况
- 验证算法结果的一致性

### 5.3 连通性差异演示
- 对比4-连通和8-连通的填充结果
- 展示不同连通性对填充区域的影响

### 5.4 连通区域查找演示
- 查找指定位置的连通区域
- 计算区域的边界框和周长
- 显示区域的详细信息

### 5.5 图像处理应用演示
- 模拟图像处理中的应用场景
- 展示噪点去除和区域分割
- 演示实际应用效果

### 5.6 性能测试演示
- 测试不同大小网格的性能表现
- 比较不同算法在大数据量下的表现
- 提供性能优化建议

## 6. Godot可视化界面使用

### 6.1 界面布局

可视化界面分为两个主要部分：
- **左侧控制面板：** 参数设置和操作按钮
- **右侧网格区域：** 交互式网格显示

### 6.2 控制面板功能

#### 网格尺寸设置
- **宽度：** 设置网格宽度（5-50）
- **高度：** 设置网格高度（5-50）

#### 算法选择
- **递归算法：** 使用递归实现
- **栈算法 (DFS)：** 使用栈的深度优先搜索
- **队列算法 (BFS)：** 使用队列的广度优先搜索

#### 连通性选择
- **4-连通：** 只考虑上下左右四个方向
- **8-连通：** 考虑周围8个方向（包括对角线）

#### 操作按钮
- **生成新网格：** 根据设置的尺寸生成新的空白网格
- **清空网格：** 清除所有填充，重置为空白状态
- **随机障碍物：** 随机生成30%的障碍物

### 6.3 网格交互操作

#### 鼠标操作
- **左键点击：** 在点击位置执行泛洪填充
- **右键拖拽：** 绘制黑色障碍物
- **中键拖拽：** 擦除（恢复为白色）

#### 颜色说明
- **白色：** 空白区域（可填充）
- **黑色：** 障碍物（不可填充）
- **彩色：** 已填充区域（不同颜色代表不同的填充操作）

### 6.4 状态信息显示

界面会实时显示以下信息：
- **操作状态：** 当前操作的结果
- **算法信息：** 使用的算法类型和连通性
- **性能数据：** 执行时间
- **区域信息：** 填充区域的边界框和周长

## 7. API使用说明

### 7.1 核心类介绍

#### Grid类
```csharp
// 创建网格
var grid = new Grid(width, height);

// 访问网格单元
int value = grid[x, y];
grid[x, y] = newValue;

// 获取邻居
var neighbors = grid.GetNeighbors(x, y, ConnectivityType.FourWay);
```

#### FloodFill类
```csharp
var floodFill = new FloodFill();

// 执行填充
var result = floodFill.Fill(grid, startX, startY, newValue, 
                           AlgorithmType.Queue, ConnectivityType.FourWay);

// 查找连通区域
var region = floodFill.FindConnectedRegion(grid, startX, startY, 
                                          ConnectivityType.FourWay);
```

#### FloodFillResult类
```csharp
// 获取填充结果
var filledGrid = result.FilledGrid;
var filledPositions = result.FilledPositions;

// 计算区域属性
var boundingBox = result.GetBoundingBox();
var perimeter = result.GetPerimeter();
```

### 7.2 算法类型

```csharp
public enum AlgorithmType
{
    Recursive,  // 递归实现
    Stack,      // 栈实现（DFS）
    Queue       // 队列实现（BFS）
}
```

### 7.3 连通性类型

```csharp
public enum ConnectivityType
{
    FourWay,    // 4-连通
    EightWay    // 8-连通
}
```

## 8. 自定义扩展

### 8.1 添加新的算法实现

1. 在 `FloodFill.cs` 中添加新的算法方法
2. 更新 `AlgorithmType` 枚举
3. 在主填充方法中添加新算法的调用

### 8.2 扩展网格功能

1. 修改 `Grid.cs` 类添加新功能
2. 更新相关的演示代码
3. 添加对应的测试用例

### 8.3 自定义可视化界面

1. 修改 `FloodFillVisualizer.cs` 添加新的UI元素
2. 更新 `Main.tscn` 场景文件
3. 添加新的交互功能

## 9. 性能优化建议

### 9.1 大型网格处理
- 对于大型网格（>1000x1000），推荐使用栈或队列实现
- 避免使用递归实现，防止栈溢出
- 考虑使用多线程并行处理

### 9.2 内存优化
- 及时释放不需要的中间结果
- 重用数据结构，避免频繁创建对象
- 监控内存使用情况

### 9.3 算法选择
- **小区域：** 递归实现简单高效
- **大区域：** 栈实现内存效率高
- **可视化：** 队列实现效果更好

## 10. 常见问题解答

### Q1: 为什么递归实现会出现栈溢出？
A: 递归实现在处理大型连通区域时，递归调用层数过深会导致栈溢出。建议对大型区域使用迭代实现。

### Q2: 4-连通和8-连通有什么区别？
A: 4-连通只考虑上下左右四个方向的相邻点，8-连通还包括对角线方向，会产生不同的填充结果。

### Q3: 如何提高算法性能？
A: 可以通过以下方式提高性能：
- 选择合适的算法实现
- 优化数据结构
- 使用并行处理
- 减少不必要的边界检查

### Q4: 可以处理什么类型的数据？
A: 当前实现使用整数网格，但可以轻松扩展到其他数据类型，如颜色、字符等。

### Q5: 如何添加自定义的填充条件？
A: 可以修改填充方法，添加自定义的条件判断逻辑，支持更复杂的填充规则。

## 11. 技术支持

如果在使用过程中遇到问题，可以：
1. 查看项目文档和源代码注释
2. 运行控制台演示了解算法行为
3. 使用Godot可视化界面进行交互式测试
4. 参考算法原理文档了解实现细节

## 12. 版本更新

### v1.0.0
- 实现基础的泛洪算法
- 提供三种算法实现方式
- 包含控制台演示和Godot可视化界面
- 完整的文档和使用指南